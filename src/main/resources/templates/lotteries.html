<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head lang="en">
    <th:block th:include="fragments/include :: head"></th:block>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MBH</title>
    <link th:href="@{'https://fonts.googleapis.com/css?family=Lato:400,700,900'}" rel="stylesheet">
    <link href="../static/css/bootstrap.css" th:href="@{/css/bootstrap.css}" rel="stylesheet" media="screen"/>
    <link href="../static/css/main.css" th:href="@{/css/main.css}" rel="stylesheet" media="screen"/>
</head>
<body>

<header id="header" class="container-fluid d-flex align-items-center">
    <a href="#" class="logo">
        <img src="../static/images/logo.svg" alt="Logo" th:src="@{/images/logo.svg}"/>
    </a>
    <ul class="navigation">
        <li class="active"><a href="#">Lotteries</a></li>
        <li><a href="#">Games</a></li>
        <li><a href="#" data-toggle="modal" data-target="#aboutModal">About Us</a></li>
    </ul>
    <button data-toggle="modal" data-target="#checkModal" class="btn-check">
        Check my Lotteries
    </button>
</header>

<div class="hero">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-6">
                <img src="" class="hero-logo" th:src="@{/images/logo2.svg}" alt="Logo">
                <p>Blockchain lottery service for charity funds around the world</p>
                <button data-toggle="modal" data-target="#aboutModal" class="btn btn-warning">Learn More</button>
            </div>
        </div>
    </div>
</div>

<main class="container-fluid">
    <div class="row">
        <div class="col-md-8 main-column">
            <h2>Active Lotteries</h2>
            <div class="lottery-boxes">
                <th:block th:each="lottery : ${activeLoteries}">
                    <div class="box lottery-box">
                        <div class="row">
                            <div class="col-md-8 d-flex align-items-center">
                                <div class="lottery-logo">
                                    <img src="" th:src="@{/images/bitmap.png}" alt="logo"/>
                                </div>
                                <div class="lottery-descr">
                                    <input type="hidden" th:value="${'/lotteries/rest/getOne?id=' + lottery.id}"/>
                                    <div class="lottery-heading">
                                        <div th:text="${lottery.name}" class="lottery-name"></div>
                                    </div>
                                    <ul class="icon-list">
                                        <li>
                                            <i class="icon-list-icon fas fa-ticket-alt text-warning"></i>
                                            <span th:text="${lottery.ticketPrice}"></span>
                                        </li>
                                        <li>
                                            <i class="icon-list-icon fab fa-ethereum"></i>
                                            <span th:text="${lottery.prizePool}"></span>
                                        </li>
                                        <li>
                                            <i class="icon-list-icon fab fa-ethereum text-primary"></i>
                                            <span th:text="${lottery.donation}"></span>
                                        </li>
                                        <li>
                                            <i class="icon-list-icon far fa-check-double"></i>
                                            <span th:text="${lottery.ticketCount}"></span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <div class="col-md-4 text-right">
                                <div class="time-label">Time Remaining</div>
                                <div class="time-value" th:text="${lottery.timeRemaining}"></div>
                            </div>
                        </div>
                    </div>
                </th:block>
            </div>

            <h2>Finished Lotteries</h2>
            <div class="lottery-boxes">
                <th:block th:each="lottery : ${inactiveLoteries}">
                    <div class="box lottery-box bg-light" data-toggle="modal" data-target="#lotteryFinishedModal">
                        <div class="row">
                            <div class="col-md-8 d-flex align-items-center">
                                <div class="lottery-logo">
                                    <img src="" th:src="@{/images/bitmap.png}" alt="logo"/>
                                </div>
                                <div class="lottery-descr">
                                    <input type="hidden" th:value="${'/lotteries/' + lottery.id}"/>
                                    <div class="lottery-heading">
                                        <i class="fas fa-trophy-alt"></i>
                                        <div th:text="${lottery.name}" class="lottery-name"></div>
                                    </div>
                                    <ul class="icon-list">
                                        <li>
                                            <i class="icon-list-icon fas fa-ticket-alt text-warning"></i>
                                            <span th:text="${lottery.ticketPrice}"></span>
                                        </li>
                                        <li>
                                            <i class="icon-list-icon fab fa-ethereum"></i>
                                            <span th:text="${lottery.prizePool}"></span>
                                        </li>
                                        <li>
                                            <i class="icon-list-icon fab fa-ethereum text-primary"></i>
                                            <span th:text="${lottery.donation}"></span>
                                        </li>
                                        <li>
                                            <i class="icon-list-icon far fa-check-double"></i>
                                            <span th:text="${lottery.ticketCount}"></span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <div class="col-md-4 text-right align-self-center">
                                <div class="finish-value text-warning" th:text="${lottery.prizePool} + ' ETH'"></div>
                            </div>
                        </div>
                    </div>
                </th:block>
            </div>
        </div>
        <div class="col-md-4 sidebar">
            <div class="box">
                <h2>Recent Payouts</h2>
                <ul class="payout-list">
                    <th:block th:each="lottery : ${inactiveLoteries}">
                        <li>
                            <i class="currency text-primary fab fa-ethereum"></i>
                            <b th:text="${lottery.payout}"></b>
                            <span th:text="'to ' + ${lottery.fundName}"></span>
                            <i class="last text-primary fal fa-link"></i>
                        </li>
                    </th:block>
                </ul>
            </div>
        </div>
    </div>
</main>

<div class="modal fade" id="aboutModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
     aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
        <div class="modal-content">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>

            <div class="row no-gutters">
                <div class="col-md-5">
                    <div class="about-content">
                        <img class="about-logo" src="" th:src="@{/images/logo3.png}" alt="Logo">
                        <p>Charity lottery service for global charity funds, which helps them gather etherium for their
                            patroned institutions.</p>
                        <form action="#" class="contact-form">
                            <h3>Please contact us!</h3>
                            <div class="form-group">
                                <label for="inputName">Name</label>
                                <input type="text" class="form-control" id="inputName" aria-describedby="emailHelp"
                                       placeholder="Enter name">
                            </div>
                            <div class="form-group">
                                <label for="inputEmail">E-mail</label>
                                <input type="email" class="form-control" id="inputEmail" aria-describedby="emailHelp"
                                       placeholder="Enter email">
                            </div>
                            <div class="form-group">
                                <label for="inputMessage">Message (optional)</label>
                                <textarea class="form-control" id="inputMessage" rows="3"></textarea>
                            </div>
                            <button type="submit" class="btn btn-block btn-primary">Send</button>
                        </form>
                    </div>
                </div>
                <div class="col-md-7 about-image">

                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="checkModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
     aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
        <div class="modal-content">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
            <div class="modal-body checkModal">
                <div class="d-flex align-items-center mb-4">
                    <i class="fas fa-ticket-alt text-warning mr-3"></i>
                    <h3>Check My Lottery Tickets</h3>
                </div>
                <p class="mb-4">Use the input form below to enter the Wallet ID you made payments from. This will allow
                    you to quickly see the list of all the lotteries you participated in and check if you won or lost in
                    them.</p>
                <form action="#">
                    <div class="form-group">
                        <label for="inputName">Enter my Wallet ID:</label>
                        <input type="text" class="form-control" id="inputName" aria-describedby="emailHelp"
                               placeholder="Contains 40 symbols, starting with 0x">
                    </div>
                    <button type="submit" class="btn btn-primary">Check Tickets</button>
                </form>
            </div>
        </div>
    </div>
</div>


<div class="modal fade" id="lotteryFinishedModal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
        <div class="modal-content">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
            <div class="lotteryFinishedModal">
                <div class="intro text-center">
                    <i class="intro-logo far fa-trophy-alt text-warning mb-4"></i>
                    <h3 class="mb-4">Lottery Finished!</h3>
                    <ul class="intro-details">
                        <li>
                            <p>Final Prize Pool</p>
                            <span id="finishedPoolPrizeSpan" class="text-warning"></span>
                        </li>
                        <li>
                            <p>Tickets Sold</p>
                            <span id="finishedTicketCountSpan"></span>
                        </li>
                        <li>
                            <p>Final Donation</p>
                            <span id="finishedDonationSpan" class="text-warning"></span>
                        </li>
                    </ul>
                </div>
                <div class="lottery-details">
                    <div class="lottery-details-heading">
                        <div class="row">
                            <div class="col-md-9 d-flex align-items-center mb-4">
                                <div class="lottery-logo">
                                    <img src="" th:src="@{/images/bitmap.png}" alt="logo">
                                </div>
                                <div class="lottery-name">CharityLife Breast Cancer Treatment</div>
                            </div>
                            <div class="col-md-3 text-right align-self-center">
                                <div class="time-label">Time Remaining</div>
                                <div class="time-value text-warning">0s</div>
                            </div>
                        </div>
                    </div>
                    <p class="mb-4">In cancer care, doctors specializing in different areas of cancer treatment—such as
                        surgery, radiation oncology, and medical oncology—work together to create a patient’s overall
                        treatment plan that combines different types of treatments.</p>
                    <div class="lottery-details-list row">
                        <div class="col-md-3 text-center">
                            <div class="lottery-details-label">
                                <i class="fas fa-ticket-alt mr-2"></i>
                                <span>Ticket Price</span>
                            </div>
                            <div class="value">
                                0,0325 ETH
                            </div>
                        </div>
                        <div class="col-md-3 text-center">
                            <div class="lottery-details-label">
                                <i class="fab fa-ethereum mr-2"></i>
                                <span>Current Prize Pool</span>
                            </div>
                            <div class="value">
                                2,442 ETH
                            </div>
                        </div>
                        <div class="col-md-3 text-center">
                            <div class="lottery-details-label">
                                <i class="fab fa-ethereum mr-2"></i>
                                <span>Current Donation</span>
                            </div>
                            <div class="value">
                                13,0325 ETH
                            </div>
                        </div>
                        <div class="col-md-3 text-center">
                            <div class="lottery-details-label">
                                <i class="far fa-check-double mr-2"></i>
                                <span>Issued Tickets Qty</span>
                            </div>
                            <div class="value">
                                243
                            </div>
                        </div>
                    </div>
                </div>
                <div class="container-fluid transaction">
                    <div class="row">
                        <div class="col-md-6 text-center">
                            <b>Winner Wallet ID:</b>
                            <p>0x4a91d42d33e1f6e24b286a52fd6a00f7aac15ee8</p>
                            <a href="#"><i class="fal fa-link mr-2"></i> <span>View Transaction</span></a>
                        </div>
                        <div class="col-md-6 text-center">
                            <b>Donation Sent to:</b>
                            <p>0x4a91d42d33e1f6e24b286a52fd6a00f7aac15ee8</p>
                            <a href="#"><i class="fal fa-link mr-2"></i> <span>View Transaction</span></a>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>

</body>
<script th:inline="javascript">

    $(function () {
        console.log("valera");

        $('div.box').on("click", function () {
            var inputElement = $(this).find("input");
            var requestUri = inputElement.val();

            var finishedPoolPrizeSpan = $('span#finishedPoolPrizeSpan');
            var finishedTicketCountSpan = $('span#finishedTicketCountSpan');
            var finishedDonationSpan = $('span#finishedDonationSpan');

            getLotteryData(requestUri).done(function (data) {
                finishedPoolPrizeSpan.text(data.prizePool + " ETH");
                finishedTicketCountSpan.text(data.ticketCount);
                finishedDonationSpan.text(data.donation + " ETH");
            })
        });
    });

    function getLotteryData(uri) {
        return $.ajax({
            url: uri,
            type: 'GET',
            dataType: 'json'
        });
    }

</script>
</html>
